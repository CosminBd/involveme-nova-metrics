(()=>{"use strict";var e,t={262:(e,t)=>{t.A=(e,t)=>{const n=e.__vccOpts||e;for(const[e,a]of t)n[e]=a;return n}},272:(e,t,n)=>{const a=Vue;var r={class:"h-6 flex items-center px-6 mb-4"},o={class:"mr-3 leading-tight text-sm font-bold"},c={class:"flex flex-wrap items-center justify-start px-6"},i={class:"flex justify-between flex-1 items-center space-x-3"},s={class:"text-4xl"},l={class:"flex flex-col flex-grow text-center"},d=["href","title"],u=["title"],m={class:"text-sm",title:"Compared to previous"},h={key:0,class:"text-sm font-bold",title:"Compared to first"},f={key:0};for(var p,g=256,v=[];g--;)v[g]=(g+256).toString(16).substring(1);function k(e){var t=0,n=e||11;if(!p||g+n>512)for(p="",g=0;t<256;t++)p+=v[256*Math.random()|0];return p.substring(g,g+++n)}const y={props:{card:{type:Object,required:!0},dashboard:{type:String,required:!1},resourceName:{type:String,default:""},resourceId:{type:[Number,String],default:""},lens:{type:String,default:""}},data:function(){return{metricUniqueId:k()}},created:function(){Nova.$on("metric-refresh",this.fetch),Nova.$on("resources-deleted",this.fetch),Nova.$on("resources-detached",this.fetch),Nova.$on("resources-restored",this.fetch),this.card.refreshWhenActionRuns&&Nova.$on("action-executed",this.fetch)},mounted:function(){Nova.$emit("vue.mounted:metric",{component:this,id:this.metricUniqueId})},beforeUnmount:function(){Nova.$off("metric-refresh",this.fetch),Nova.$off("resources-deleted",this.fetch),Nova.$off("resources-detached",this.fetch),Nova.$off("resources-restored",this.fetch),Nova.$off("action-executed",this.fetch),Nova.$emit("vue.unmounted:metric",{component:this,id:this.metricUniqueId})},methods:{fetch:function(){this.loading=!0,this.minimum(Nova.request().get(this.metricEndpoint,this.metricPayload)).then(this.handleFetchCallback())},handleFetchCallback:function(){return function(){}},minimum:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return Promise.all([e,new Promise((function(e){setTimeout((function(){return e()}),t)}))]).then((function(e){return e[0]}))}},computed:{metricEndpoint:function(){var e=""!==this.lens?"/lens/".concat(this.lens):"";return this.resourceName&&this.resourceId?"/nova-api/".concat(this.resourceName).concat(e,"/").concat(this.resourceId,"/metrics/").concat(this.card.uriKey):this.resourceName?"/nova-api/".concat(this.resourceName).concat(e,"/metrics/").concat(this.card.uriKey):"/nova-api/dashboards/cards/".concat(this.dashboard,"/metrics/").concat(this.card.uriKey)},metricPayload:function(){return{}},userTimezone:function(){return Nova.config("userTimezone")||Nova.config("timezone")}}},x={props:["card"],mixins:[y],data:function(){return{metricsData:[],selectedRangeKey:null,loading:!0}},computed:{hasRanges:function(){return this.card.ranges.length>0},metricPayload:function(){var e={params:{timezone:this.userTimezone}};return this.hasRanges&&(e.params.range=this.selectedRangeKey),e}},created:function(){this.hasRanges&&(this.selectedRangeKey=this.card.selectedRangeKey||this.card.ranges[0].value),this.fetch()},methods:{handleRangeSelected:function(e){this.selectedRangeKey=e.value,this.fetch()},handleFetchCallback:function(){var e=this;return function(t){e.metricsData=t.data.value,e.loading=!1}},calculatePercentageTo:function(e,t){return 0===e?100:0===this.metricsData[t].value?0:Math.round(this.metricsData[e].value/this.metricsData[t].value*1e4)/100},formatNumber:function(e){return new Intl.NumberFormat("en-US",{maximumFractionDigits:0}).format(e)}}};var N=n(262);const b=(0,N.A)(x,[["render",function(e,t,n,p,g,v){var k=(0,a.resolveComponent)("SelectControl"),y=(0,a.resolveComponent)("LoadingCard");return(0,a.openBlock)(),(0,a.createBlock)(y,{loading:e.loading,class:"py-3 im-nova-metrics"},{default:(0,a.withCtx)((function(){return[(0,a.createElementVNode)("div",r,[(0,a.createElementVNode)("h3",o,(0,a.toDisplayString)(n.card.name),1),v.hasRanges?((0,a.openBlock)(),(0,a.createBlock)(k,{key:0,modelValue:e.selectedRangeKey,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.selectedRangeKey=t}),"aria-label":e.__("Select Ranges"),options:n.card.ranges,class:"ml-auto w-[9rem] flex-shrink-0",size:"xxs",onSelected:v.handleRangeSelected},null,8,["modelValue","aria-label","options","onSelected"])):(0,a.createCommentVNode)("",!0)]),(0,a.createElementVNode)("div",c,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.metricsData,(function(n,r){return(0,a.openBlock)(),(0,a.createElementBlock)("div",{key:r,class:"flex items-center justify-between h-14 w-1/4"},[(0,a.createElementVNode)("div",i,[(0,a.createElementVNode)("span",s,(0,a.toDisplayString)(v.formatNumber(n.value)),1),(0,a.createElementVNode)("div",l,[n.link?((0,a.openBlock)(),(0,a.createElementBlock)("a",{key:0,href:n.link,title:n.tooltip,target:"_blank",class:"link-default flex-grow"},(0,a.toDisplayString)(n.name),9,d)):((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:1,title:n.tooltip,class:"flex-grow"},(0,a.toDisplayString)(n.name),9,u)),(0,a.createElementVNode)("div",null,[(0,a.createElementVNode)("span",m,(0,a.toDisplayString)(v.calculatePercentageTo(r,r-1))+"%",1),r>1?((0,a.openBlock)(),(0,a.createElementBlock)("span",h,"Â / "+(0,a.toDisplayString)(v.calculatePercentageTo(r,0))+"%",1)):(0,a.createCommentVNode)("",!0)])])]),r!==e.metricsData.length-1?((0,a.openBlock)(),(0,a.createElementBlock)("div",f,t[1]||(t[1]=[(0,a.createElementVNode)("svg",{class:"w-12 h-12",fill:"none",stroke:"currentColor","stroke-width":"1.5",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[(0,a.createElementVNode)("path",{d:"M8.25 4.5l7.5 7.5-7.5 7.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))):(0,a.createCommentVNode)("",!0)])})),128))])]})),_:1},8,["loading"])}]]);var B={class:"h-6 flex items-center px-6 mb-4"},E={class:"mr-3 leading-tight text-sm font-bold"},R={class:"grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 gap-2 gap-y-4"},S={class:"text-4xl"},V={class:"flex flex-col text-center"},w=["href","title"],C=["title"];const D={props:["card"],mixins:[y],data:function(){return{metricsData:[],selectedRangeKey:null,loading:!0}},computed:{hasRanges:function(){return this.card.ranges.length>0},metricPayload:function(){var e={params:{timezone:this.userTimezone}};return this.hasRanges&&(e.params.range=this.selectedRangeKey),e}},created:function(){this.hasRanges&&(this.selectedRangeKey=this.card.selectedRangeKey||this.card.ranges[0].value),this.fetch()},methods:{handleFetchCallback:function(){var e=this;return function(t){e.metricsData=t.data.value,e.loading=!1}}}},K=(0,N.A)(D,[["render",function(e,t,n,r,o,c){var i=(0,a.resolveComponent)("SelectControl"),s=(0,a.resolveComponent)("LoadingCard");return(0,a.openBlock)(),(0,a.createBlock)(s,{loading:e.loading,class:"py-3 im-nova-metrics"},{default:(0,a.withCtx)((function(){return[(0,a.createElementVNode)("div",B,[(0,a.createElementVNode)("h3",E,(0,a.toDisplayString)(n.card.name),1),c.hasRanges?((0,a.openBlock)(),(0,a.createBlock)(i,{key:0,modelValue:e.selectedRangeKey,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.selectedRangeKey=t}),"aria-label":e.__("Select Ranges"),options:n.card.ranges,class:"ml-auto w-[9rem] flex-shrink-0",size:"xxs",onSelected:e.handleRangeSelected},null,8,["modelValue","aria-label","options","onSelected"])):(0,a.createCommentVNode)("",!0)]),(0,a.createElementVNode)("div",R,[((0,a.openBlock)(!0),(0,a.createElementBlock)(a.Fragment,null,(0,a.renderList)(e.metricsData,(function(e,t){return(0,a.openBlock)(),(0,a.createElementBlock)("div",{key:t,class:"justify-center text-center"},[(0,a.createElementVNode)("span",S,(0,a.toDisplayString)(e.value),1),(0,a.createElementVNode)("div",V,[e.link?((0,a.openBlock)(),(0,a.createElementBlock)("a",{key:0,href:e.link,title:e.tooltip,target:"_blank",class:"link-default"},(0,a.toDisplayString)(e.name),9,w)):((0,a.openBlock)(),(0,a.createElementBlock)("span",{key:1,class:"text-base",title:e.tooltip},(0,a.toDisplayString)(e.name),9,C))])])})),128))])]})),_:1},8,["loading"])}]]);Nova.booting((function(e,t){e.component("funnel-metric",b),e.component("multiple-value-metric",K)}))},799:()=>{}},n={};function a(e){var r=n[e];if(void 0!==r)return r.exports;var o=n[e]={exports:{}};return t[e](o,o.exports,a),o.exports}a.m=t,e=[],a.O=(t,n,r,o)=>{if(!n){var c=1/0;for(d=0;d<e.length;d++){for(var[n,r,o]=e[d],i=!0,s=0;s<n.length;s++)(!1&o||c>=o)&&Object.keys(a.O).every((e=>a.O[e](n[s])))?n.splice(s--,1):(i=!1,o<c&&(c=o));if(i){e.splice(d--,1);var l=r();void 0!==l&&(t=l)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[n,r,o]},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={192:0,757:0};a.O.j=t=>0===e[t];var t=(t,n)=>{var r,o,[c,i,s]=n,l=0;if(c.some((t=>0!==e[t]))){for(r in i)a.o(i,r)&&(a.m[r]=i[r]);if(s)var d=s(a)}for(t&&t(n);l<c.length;l++)o=c[l],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(d)},n=self.webpackChunkinvolveme_metrics_funnel=self.webpackChunkinvolveme_metrics_funnel||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),a.O(void 0,[757],(()=>a(272)));var r=a.O(void 0,[757],(()=>a(799)));r=a.O(r)})();